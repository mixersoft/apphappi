<div class="container">
  <div class="row">
    <div class="span2" ng-include="'/views/drawer/_drawer.html'">
    </div>
    <div class="span10">
      <div class="notify">
        <alert ng-repeat="alert in notify.alert()" type="alert.type" close="notify.close(alert.key)">{{alert.msg}}</alert>
      </div>
      <!--Body content-->


      <div ng-model="card" ng-show='deck.size()==0'
      class="challenge card empty-card summary list-unstyled text-center">
        <div class="header">
          <figure class="icon">
            <i class="icon fa fa-meh-o fa-3x"></i>
            <figcaption class="category">Move Along</figcaption>
          </figure>  
        </div>  
        <div class="body">
          <h2 class="title">There's nothing to see here...</h2>
        </div>
        <div class="footer">
          <div class='btn-group'>
            <button type="button" class="btn btn-primary" 
            ng-click="drawerShowAll()">Show All Cards</button>
          </div>
        </div>
      </div>
      <div class="filmstrip"
          hm-swipe="(drawer.state.filter.status !='active') && swipe('filmstrip', $event)"
          hm-swipe-opts="{drag_block_horizontal: true}">

        <div class="hscroll" ng-style="setFilmstripPos()">
          <div class="card-wrap inline"
          ng-repeat="card in deck.cards()" 
          >
            <div ng-model="card" 
              hm-swipe="swipe('card', $event)"
              hm-swipe-opts="{drag_block_vertical: true}"
              class="challenge card summary list-unstyled text-center">
                <span class="page-no pull-right label label-info"
                ng-click="deck.nextCard()">{{($index + 1) + "/"  + deck.size()}}</span>
                <div class="header">
                  <figure class="icon">
                    <i class="icon {{card.icon}} fa-3x"></i>
                    <figcaption class="category">{{card.category.join(":")}}</figcaption>
                  </figure>  
                </div>  
                <div class="body">
                  <h4 class="heading">Find a Happi moment</h4>
                  <h2 class="title">{{card.title}}</h2>
                  <p class="description text-left">{{card.description}}</p> 
                  <div class="meta well">
                    <div class="header inverse">Challenge</div>
                    <dl class="challenge-stats stats-wrap force-dl-horizontal">
                      <div><b>{{card.humanize.completions}} completed</b></div>
                      <dt>Accept</dt><dd>{{card.humanize.acceptPct | number:1}}%</dd>
                      <dt>Pass</dt><dd>{{card.humanize.passPct | number:1}}%</dd>
                      <dt>Avg Time</dt><dd>{{card.humanize.avgDuration || 0}}</dd>
                      <rating value="card.humanize.avgRating" readonly='true' state-on="'fa fa-star'" state-off="'fa fa-star-o'"></rating>
                      <span class="label label-default" title="average rating for this challenge">{{card.humanize.avgRating}}</span>
                    </dl>
                  </div>
                </div>
                <div class="footer">
                  <div class='btn-group status-new status-pass status-all'
                  ng-show="['new','pass'].indexOf(card.status)>=0">
                    <button type="button" class="btn btn-primary" ng-click="challenge_new_moment()">Accept</button>
                    <button type="button" class="btn btn-default" ng-click="challenge_later()">Later</button>
                    <button type="button" ng-click="deck.nextCard()"  class="btn btn-default">Pass</button>
                  </div>
                  <div class="btn-group status-active"
                  ng-show="['active'].indexOf(card.status)>=0">
                    <button type="button" class="btn btn-default" ng-click="challenge_done()">Done</button>
                    <span class='no-camera-hack'>
                      <button type="button" class="btn btn-primary" ng-click="challenge_getPhoto($event)">
                        <i class="fa fa-camera"></i> Camera Roll
                      </button>
                      <input id="html5-get-file" class="transparent-overlay"  type="file" accept="image/jpeg"
                       ng-click="challenge_getPhoto($event)"
                       ng-if="!window.navigator.camera"/>  
                    </span>
                    <button type="button" class="btn btn-default" ng-click="challenge_pass()">Pass</button>
                  </div> 
                  <div class="btn-group status-complete"
                  ng-show="['complete'].indexOf(card.status)>=0">
                    <button type="button" class="btn btn-primary" ng-click="challenge_open()">Open</button>
                    <button type="button" class="btn btn-default" title="repeat this challenge" ng-click="challenge_new_moment()"><i class="fa fa-copy"></i> Repeat</button>
                    <button type="button" class="btn btn-default" ng-click="deck.nextCard()">Next</button>
                  </div>
                  <div class="btn-group status-working"
                  ng-show="['working'].indexOf(card.status)>=0">
                    <button type="button" class="btn btn-primary" ng-click="challenge_open()">Open</button>
                    <button type="button" class="btn btn-default" ng-click="deck.nextCard()">Next</button>
                  </div>
                  <div class="btn-group status-sleep"
                  ng-show="['sleep'].indexOf(card.status)>=0">
                    <button type="button" class="btn btn-primary">Wake</button>
                  </div>
                </div>
            </div>
            <div class="gallery clearfix">
              <div ng-repeat="photo in card.challengePhotos" ng-include="'/common/templates/_thumbnail.html'">
              </div>
            </div>  
          </div>
      </div>
            
    </div>
  </div>
</div>